# ⬆️ AstrBot 插件更新管理器 astrbot_plugin_update_manager

你是否为 AstrBot 插件`逐个更新`感到烦恼？是否希望 `定时自动检查更新`并`自动更新`？

那么，这个插件就是为你准备的！

## v1.0.0

这是一个用于 AstrBot 的插件，它提供了一键更新所有已安装插件的功能，并且支持定时检查。

## ✨ 主要功能

- **一键更新所有插件**：通过简单的命令即可检查并更新所有需要更新的 AstrBot 插件。
- **定时自动检查与更新**：支持配置定时任务，自动检查插件更新并在后台执行更新操作。
- **代理支持**：可以在插件配置中设置代理地址，以便在网络受限环境下进行插件更新。
- **更新结果摘要**：更新完成后，会提供详细的成功或失败信息，方便用户了解更新状态。
- **日志记录**：详细记录更新过程中的信息、警告和错误，便于问题排查。
- **管理员权限控制**：更新所有插件的命令仅限管理员使用。

## 📦 安装

将本插件放置于 AstrBot 的 `data/plugins` 目录下即可。

## ⚙️ 配置项

您可以在 AstrBot 的配置文件中为本插件配置以下项：

- `interval_hours` (int): 插件定时检查更新的间隔时间（单位：小时，默认为 `24` 小时）。设置为 `0` 则禁用定时更新功能。
- `github_proxy` (str): 用于插件更新的 github 加速地址（可以参考 astrbot 设置中的选项）。例如: `"https://gh-proxy.com"`。如果您的网络环境需要代理才能访问 GitHub，请配置此项。

## 🚀 指令说明

以下是本插件支持的指令：

| 指令           | 别名                               | 功能说明                                | 权限   |
| :------------- | :--------------------------------- | :-------------------------------------- | :----- |
| `更新所有插件` | `updateallplugins`, `更新全部插件` | 检查并更新所有需要更新的 AstrBot 插件。 | 管理员 |

## 💡 使用示例

1.  **手动触发更新：**
    作为管理员，在聊天中发送：
    `更新所有插件`，
    机器人将会返回更新结果摘要。

2.  **配置定时更新：**
    在 AstrBot 的配置文件中，找到或添加 `astrbot_plugin_update_manager` 配置节，并设置 `interval_hours` 项为希望的更新间隔（单位：小时）。

## ⚠️ 注意事项

- 插件更新依赖于 AstrBot 内部的插件管理功能。如果 AstrBot 核心模块导入失败，更新功能将不可用。
- 目前由于 AstrBot 内部函数对插件状态标记的处理存在问题，`可能导致部分插件不能正常更新。`（已提 issue）

## 🐞 已知问题和 ToDo List

- 目前由于 AstrBot 内部函数对插件状态标记的处理存在问题，`可能导致部分插件不能正常更新。`（已提 issue)
